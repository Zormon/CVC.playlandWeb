function $(id){return document.getElementById(id)}function $$(sel){return document.querySelector(sel)}function $$$(sel){return document.querySelectorAll(sel)}function may(f,...args){try{return f(...args)}catch{}}function fetchJson(url,send=null,method="POST"){return new Promise(async resolve=>{var resp=await fetch(url,{method:method,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(send)});let json={};try{json=await resp.json()}catch{}json._httpCode=resp.status,resolve(json)})}class toolTip{constructor(element){void 0===element.dataset.tt_text&&void 0===element.dataset.tt_pos||(this.element=element,this.position=element.dataset.tt_pos,this.text=element.dataset.tt_text,this.div=document.createElement("div"),this.div.className="ttBox "+this.position,this.div.textContent=this.text,this.element.onmouseenter=()=>{this.show()},this.element.onmouseleave=()=>{this.hide()})}show(){var rectEl=this.element.getBoundingClientRect();switch(document.body.appendChild(this.div),this.position){case"right":this.div.style.left=rectEl.right+10+"px",this.div.style.top=rectEl.top+rectEl.height/2-this.div.offsetHeight/2+"px";break;case"left":this.div.style.left=rectEl.left-this.div.offsetWidth-10+"px",this.div.style.top=rectEl.top+rectEl.height/2-this.div.offsetHeight/2+"px";break;case"up":this.div.style.left=rectEl.left+rectEl.width/2-this.div.offsetWidth/2+"px",this.div.style.top=rectEl.top-this.div.offsetHeight+"px";break;case"down":this.div.style.left=rectEl.left+rectEl.width/2-this.div.offsetWidth/2+"px",this.div.style.top=rectEl.bottom+10+"px"}}hide(){document.body.removeChild(this.div)}}function contentBox(el,type,msg){if(msg){var div=document.createElement("div");div.className=`contentBox ${type}Box`,div.textContent=msg,el.contains($$(`.${type}Box`))||el.appendChild(div)}else try{$$(`.${type}Box`).remove()}catch(e){}}function debounce(func,wait){var timeout;return()=>{timeout||func.apply(this,arguments),clearTimeout(timeout),timeout=setTimeout(()=>{timeout=!1},wait)}}function sortJson(json,param,numeric=!1){numeric?json.sort((a,b)=>b[param]-a[param]):json.sort((a,b)=>a[param].toString().localeCompare(b[param]))}class selectModal{constructor(target,text,type="list",search=!1,groups=!1){this.target=target,this.select=$(target),this.multiple=this.select.multiple,this.text=text,this.search=search,this.groups=groups,this.opts=this.select.querySelectorAll("option:enabled"),this.groupsMenuShown=!1,this.div=document.createElement("div"),this.ul=document.createElement("ul"),this.button=document.createElement("button"),this.div.className="selectModal-div "+type+(this.multiple?" multiple":""),this.div.id="selectModal-"+target,this.groupsMenu=null,this.groupsBtn=null,this.opts.forEach(op=>{var li=document.createElement("li"),span=(li.dataset.value=op.value,li.onclick=e=>{this.change(e.target.dataset.value)},document.createElement("span"));span.textContent=op.textContent,li.appendChild(span),op.dataset.icon&&((span=document.createElement("img")).src=op.dataset.icon,li.appendChild(span)),this.ul.appendChild(li)});text=document.createElement("label");if(text.textContent=this.text,this.div.appendChild(text),this.search){let search=document.createElement("input");search.type="search",search.placeholder="Buscar",this.div.appendChild(search),search.onkeyup=e=>{this.filter(e.currentTarget.value)}}if(this.multiple&&!1!==this.groups){this.groupsBtn=document.createElement("button"),this.groupsBtn.textContent="Grupos ↓",this.groupsBtn.className="groupsBtn flat",this.groupsBtn.onclick=e=>{e.target==e.currentTarget&&this.toggleGroupsMenu()},this.div.appendChild(this.groupsBtn),this.groupsMenu=document.createElement("ul"),this.groupsMenu.className="groupsMenu";var grp,search=document.createElement("li"),groups=(search.dataset.items=[],document.createElement("span")),type=(groups.textContent="Todos",document.createElement("button")),target=(type.className="addBtn",type.textContent="+",document.createElement("button"));target.className="delBtn",target.textContent="-",search.appendChild(groups),search.appendChild(type),search.appendChild(target),this.groupsMenu.appendChild(search);for(grp of Object.values(this.groups)){let li=document.createElement("li"),span=(li.dataset.items=grp.devices,document.createElement("span")),addBtn=(span.textContent=grp.name,document.createElement("button")),delBtn=(addBtn.className="addBtn",addBtn.textContent="+",document.createElement("button"));delBtn.className="delBtn",delBtn.textContent="-",li.appendChild(span),li.appendChild(addBtn),li.appendChild(delBtn),this.groupsMenu.appendChild(li)}this.groupsMenu.querySelectorAll(".addBtn").forEach(btn=>{btn.onclick=e=>{this.mark(!0,e.currentTarget.parentElement.dataset.items)}}),this.groupsMenu.querySelectorAll(".delBtn").forEach(btn=>{btn.onclick=e=>{this.mark(!1,e.currentTarget.parentElement.dataset.items)}}),this.groupsBtn.appendChild(this.groupsMenu)}this.div.appendChild(this.ul),this.button.textContent=this.text,this.button.className="selectModal empty",this.button.className+=this.multiple?" multiple":"",this.select.parentElement.insertBefore(this.button,this.select),this.button.onclick=e=>{e.preventDefault(),e.stopPropagation(),this.show()},this.button.onmousedown=e=>{e.preventDefault()},this.select.addEventListener("change",this.update.bind(this)),this.update()}mark(enable,items){""!=items?items.split(",").forEach(it=>{try{this.select.querySelector(`option[value="${it}"]`).selected=enable}catch(e){}}):this.select.querySelectorAll("option").forEach(op=>{op.selected=enable}),this.select.dispatchEvent(new Event("change",{bubbles:!0}))}toggleGroupsMenu(){this.multiple&&(this.groupsBtn.classList.toggle("shown"),this.groupsMenuShown=!this.groupsMenuShown)}filter(pattern){pattern=pattern.toUpperCase(),this.ul.childNodes.forEach(li=>{li.querySelector("span").textContent.toUpperCase().includes(pattern)?li.style.display="":li.style.display="none"})}change(n){this.multiple?this.select.querySelector(`option[value="${n}"]`).selected^=!0:(this.select.value=n,this.close()),this.select.dispatchEvent(new Event("change",{bubbles:!0}))}show(){var closeArea;document.body.contains($("closeWrapper-"+this.target))||((closeArea=document.createElement("button")).id="closeWrapper-"+this.target,closeArea.className="selectModalCloseArea",closeArea.onclick=this.close.bind(this),document.body.appendChild(closeArea),closeArea=this.button.getBoundingClientRect(),this.div.style.top=closeArea.top+"px",this.div.style.left=closeArea.left+"px",this.ul.style.maxHeight=window.innerHeight-closeArea.top-70+"px",document.body.appendChild(this.div),this.search&&this.div.querySelector('input[type="search"]').focus())}close(){try{$("closeWrapper-"+this.target).remove()}catch(e){}this.div.remove(),this.search&&(this.div.querySelector('input[type="search"]').value="",this.filter(""))}update(){this.ul.childNodes.forEach(el=>{el.classList.remove("selected")});var selected=this.getSelectedOptions();let text="";selected.forEach(el=>{text+=el.textContent+",";try{this.ul.querySelector(`li[data-value="${el.value}"]`).classList.add("selected")}catch(e){}}),text=text.slice(0,-1),0<selected.length?(this.button.textContent=text,this.button.classList.remove("empty")):(this.button.textContent=this.text,this.button.classList.add("empty"))}getSelectedOptions(){let sel=[];return this.opts.forEach(op=>{op.selected&&sel.push(op)}),sel}}class editableList{constructor(target,data,options={}){this.target=target,this.container=$(target),this.ul=document.createElement("ul"),this.data=data,this.addButton=!("add"in options)||options.add,this.delButton=!("delete"in options)||options.delete,this.headers=!("header"in options)||options.header,this.init()}init(){if(this.container.classList.add("editableList"),this.headers){let header=document.createElement("div");header.className="header row",this.data.fields.forEach(field=>{var span=document.createElement("span");span.textContent=field.name,span.className="width"in field?"f"+field.width:"f1",header.appendChild(span)}),this.container.appendChild(header)}var button;this.data.items.forEach(item=>{this.new(item)}),this.container.appendChild(this.ul),this.addButton&&((button=document.createElement("button")).className="flat addButton",button.textContent="Añadir",button.onclick=e=>{e.preventDefault(),this.new()},this.container.appendChild(button))}new(item=!1){let li=document.createElement("li");li.className="row input";for(let i=0;i<this.data.fields.length;i++){var input=document.createElement("input");input.type=this.data.fields[i].type,input.className="width"in this.data.fields[i]?"f"+this.data.fields[i].width:"f1","name"in this.data.fields[i]&&(input.dataset.name=this.data.fields[i].name),item&&(input.value=item[i]),li.appendChild(input)}var button,i;this.delButton&&((button=document.createElement("button")).className="flat",(i=document.createElement("i")).className="icon-delete",button.appendChild(i),button.onclick=()=>{li.remove()},li.appendChild(button)),this.ul.appendChild(li)}getFields(){return this.data.fields}getData(){let data=[];return this.ul.querySelectorAll("li").forEach(li=>{var itemData=[];for(let i=0;i<this.data.fields.length;i++)itemData.push(li.querySelectorAll("input")[i].value);data.push(itemData)}),data}}function modalBox2(title,content,buttons=[{text:"Aceptar",action:""}],width=70,maxHeight=70){document.body.contains($("modalBox"))&&$("modalBox").remove();var modalBox=document.createElement("div"),modalInner=(modalBox.id="modalBox",document.createElement("div")),width=(modalInner.style.width=width+"%",modalInner.style.maxHeight=maxHeight+"%",document.createElement("div")),maxHeight=(width.id="modalHeader",width.textContent=title[0],width.style.color=title[1],document.createElement("div"));maxHeight.id="modalContent",maxHeight.innerHTML=content;const modalButtons=document.createElement("div");modalButtons.id="modalButtons",buttons.forEach(el=>{var button=document.createElement("button");button.textContent=el.text,button.style.backgroundColor=el.color,button.style.flexGrow=el.size||1,button.onclick=async()=>{await el.action()&&$("modalBox").remove()},modalButtons.appendChild(button)}),modalBox.onclick=e=>{"modalBox"!=e.target.id&&"cancelBtn"!=e.target.className||$("modalBox").remove()},modalInner.appendChild(width),modalInner.appendChild(maxHeight),modalInner.appendChild(modalButtons),modalBox.appendChild(modalInner),document.body.appendChild(modalBox)}function modalConfirm(msg,action){modalBox(`<h1>${msg}</h1>`,[{text:"No"},{text:"Si",action:()=>(action(),!0)}],30)}function arrayRemove(arr,value){return arr.filter(function(ele){return ele!=value})}function toggleRowActions(ev){ev=ev.currentTarget.parentElement.parentElement;if(ev.classList.contains("actionsVisible"))ev.classList.remove("actionsVisible");else{try{$$(".actionsVisible").classList.remove("actionsVisible")}catch(e){}ev.classList.add("actionsVisible")}}class sortableList{constructor(target,data){this.target=target,this.ol=$(target),this.data=data,this.ol.classList.add("sortableList"),this.render()}delete(index){this.data.splice(index,1),this.render()}render(){for(;this.ol.firstChild;)this.ol.removeChild(this.ol.lastChild);var li;this.data.length<1?((li=document.createElement("li")).dataset.index=0,li.textContent="Listado vacío",li.addEventListener("dragover",this.dragover),li.addEventListener("drop",this.drop.bind(this)),this.ol.appendChild(li)):this.data.forEach((el,index)=>{var li=document.createElement("li"),index=(li.draggable=!0,li.dataset.index=index,li.addEventListener("dragstart",this.dragstart),li.addEventListener("dragover",this.dragover),li.addEventListener("drop",this.drop.bind(this)),void 0!==el.color&&(li.style="border-color: "+el.color),void 0!==el.img&&((index=document.createElement("img")).src=el.img,index.draggable=!1,index.className="thumb",li.appendChild(index)),document.createElement("div")),el=(index.className="content",index.innerHTML=el.content,li.appendChild(index),document.createElement("div")),index=(el.className="actions",document.createElement("button")),icon=(index.className="flat delete",index.addEventListener("click",this.delete.bind(this,li.dataset.index)),document.createElement("i"));icon.className="icon-delete",index.appendChild(icon),el.appendChild(index),li.appendChild(el),this.ol.appendChild(li)})}dragstart(e){e.dataTransfer.setData("index",e.target.dataset.index)}dragover(e){e.preventDefault()}drop(e){e.preventDefault();var data,targetIndex=e.currentTarget.dataset.index;""!=e.dataTransfer.getData("copy")?(data=JSON.parse(e.dataTransfer.getData("copy")),this.data.splice(targetIndex,0,data),this.render()):(data=parseInt(e.dataTransfer.getData("index")))!=targetIndex&&(this.data.splice(targetIndex,0,this.data[data]),delete this.data[data+1],this.render())}setData(data){this.data=data,this.render()}getData(property){return this.data.map(a=>a[property])}}class sortableListCatalog{constructor(target,data){this.target=target,this.ol=$(target),this.data=data,this.ol.classList.add("sortableListCatalog"),this.render()}render(){for(;this.ol.firstChild;)this.ol.removeChild(this.ol.lastChild);this.data.forEach((el,index)=>{var li=document.createElement("li"),index=(li.draggable=!0,li.dataset.index=index,li.addEventListener("dragstart",this.dragstart.bind(this)),void 0!==el.color&&(li.style="border-color: "+el.color),void 0!==el.img&&((index=document.createElement("img")).src=el.img,index.draggable=!1,index.className="thumb",li.appendChild(index)),document.createElement("div"));index.className="content",index.innerHTML=el.content,li.appendChild(index),this.ol.appendChild(li)})}dragstart(e){e.dataTransfer.setData("copy",JSON.stringify(this.data[e.target.dataset.index]))}}class selectableList{constructor(target){this.target=target,this.list=$(target),this.selected=[],this.lastSelected=0,this.list.classList.add("selectable-list"),Array.from(this.list.children).forEach((li,i)=>{li.dataset.index=i,li.onclick=e=>{var index=parseInt(e.currentTarget.dataset.index);this.select(index,e.shiftKey,e.ctrlKey)}})}selectRange(from,to){var min=to<from?to:from,max=to<from?from:to;this.all(!1);for(let i=min;i<=max;i++)this.selected.push(i),this.list.children[i].classList.add("selected")}select(index,line=!1,toggle=!1){var indexEl=this.list.children[index];line?this.selectRange(this.lastSelected,index):toggle?indexEl.classList.toggle("selected")?this.selected.push(index):this.selected=arrayRemove(this.selected,index):(this.all(!1),indexEl.classList.add("selected"),this.selected.push(index),this.lastSelected=index)}all(selected){selected?this.selectRange(0,this.list.children.length):(Array.from(this.list.children).forEach(li=>{li.classList.remove("selected")}),this.selected=[])}getSelectedNodes(){let nodes=[];return this.selected.forEach(i=>{nodes.push(this.list.children[i])}),nodes}}var isTouchScreen=window.matchMedia("(pointer: coarse)").matches;class virtualKeyboard{constructor(target){this.keyboard=$(target),this.input=$(this.keyboard.dataset.input),this.keys=this.keyboard.querySelectorAll("button");for(let but of this.keys)but.onclick=()=>{this.putKey(but.dataset.key)}}putKey(char){switch(char){case"-b":this.input.value=this.input.value.slice(0,-1);break;case"-x":this.input.value="";break;default:this.input.value.length<this.input.dataset.vkmaxlength&&(this.input.value+=char,this.input.dispatchEvent(new Event("vkPut")),this.input.value.length==this.input.dataset.vkmaxlength)&&this.input.dispatchEvent(new Event("vkMaxReached"))}}}function letraDNI(dni){return["T","R","W","A","G","M","Y","F","P","D","X","B","N","J","Z","S","Q","V","H","L","C","K","E","T"][dni%23]}export{$,$$,$$$,may,fetchJson,toolTip,contentBox,debounce,sortJson,selectModal,modalBox2,modalConfirm,toggleRowActions,editableList,sortableList,sortableListCatalog,arrayRemove,selectableList,virtualKeyboard,isTouchScreen,letraDNI};
//# sourceMappingURL=module-admin.min.js.map